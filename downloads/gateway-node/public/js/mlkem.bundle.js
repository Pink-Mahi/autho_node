var MlKemModule=(()=>{var It=Object.create;var j=Object.defineProperty;var Tt=Object.getOwnPropertyDescriptor;var jt=Object.getOwnPropertyNames;var Et=Object.getPrototypeOf,Ft=Object.prototype.hasOwnProperty;var Ht=(e=>typeof require<"u"?require:typeof Proxy<"u"?new Proxy(e,{get:(t,i)=>(typeof require<"u"?require:t)[i]}):e)(function(e){if(typeof require<"u")return require.apply(this,arguments);throw Error('Dynamic require of "'+e+'" is not supported')});var Nt=(e,t)=>{for(var i in t)j(e,i,{get:t[i],enumerable:!0})},tt=(e,t,i,r)=>{if(t&&typeof t=="object"||typeof t=="function")for(let n of jt(t))!Ft.call(e,n)&&n!==i&&j(e,n,{get:()=>t[n],enumerable:!(r=Tt(t,n))||r.enumerable});return e};var Kt=(e,t,i)=>(i=e!=null?It(Et(e)):{},tt(t||!e||!e.__esModule?j(i,"default",{value:e,enumerable:!0}):i,e)),Mt=e=>tt(j({},"__esModule",{value:!0}),e);var fe={};Nt(fe,{MlKem1024:()=>$,MlKem512:()=>C,MlKem768:()=>R,MlKemError:()=>k,sha3_256:()=>L,sha3_512:()=>O,shake128:()=>B,shake256:()=>S});var k=class extends Error{constructor(t){let i;t instanceof Error?i=t.message:typeof t=="string"?i=t:i="",super(i),this.name=this.constructor.name}};var E=[2285,2571,2970,1812,1493,1422,287,202,3158,622,1577,182,962,2127,1855,1468,573,2004,264,383,2500,1458,1727,3199,2648,1017,732,608,1787,411,3124,1758,1223,652,2777,1015,2036,1491,3047,1785,516,3321,3009,2663,1711,2167,126,1469,2476,3239,3058,830,107,1908,3082,2378,2931,961,1821,2604,448,2264,677,2054,2226,430,555,843,2078,871,1550,105,422,587,177,3094,3038,2869,1574,1653,3083,778,1159,3182,2552,1483,2727,1119,1739,644,2457,349,418,329,3173,3254,817,1097,603,610,1322,2044,1864,384,2114,3193,1218,1994,2455,220,2142,1670,2144,1799,2051,794,1819,2475,2459,478,3221,3021,996,991,958,1869,1522,1628],Q=[1701,1807,1460,2371,2338,2333,308,108,2851,870,854,1510,2535,1278,1530,1185,1659,1187,3109,874,1335,2111,136,1215,2945,1465,1285,2007,2719,2726,2232,2512,75,156,3e3,2911,2980,872,2685,1590,2210,602,1846,777,147,2170,2551,246,1676,1755,460,291,235,3152,2742,2907,3224,1779,2458,1251,2486,2774,2899,1103,1275,2652,1065,2881,725,1508,2368,398,951,247,1421,3222,2499,271,90,853,1860,3203,1162,1618,666,320,8,2813,1544,282,1838,1293,2314,552,2677,2106,1571,205,2918,1542,2721,2597,2312,681,130,1602,1871,829,2946,3065,1325,2756,1861,1474,1202,2367,3147,1752,2707,171,3127,3042,1907,1836,1517,359,758,1441];var F=BigInt(4294967295),et=BigInt(32);function Vt(e,t=!1){return t?{h:Number(e&F),l:Number(e>>et&F)}:{h:Number(e>>et&F)|0,l:Number(e&F)|0}}function rt(e,t=!1){let i=e.length,r=new Uint32Array(i),n=new Uint32Array(i);for(let o=0;o<i;o++){let{h:s,l:u}=Vt(e[o],t);[r[o],n[o]]=[s,u]}return[r,n]}var nt=(e,t,i)=>e<<i|t>>>32-i,it=(e,t,i)=>t<<i|e>>>32-i,ot=(e,t,i)=>t<<i-32|e>>>64-i,st=(e,t,i)=>e<<i-32|t>>>64-i;function Ct(e){return e instanceof Uint8Array||ArrayBuffer.isView(e)&&e.constructor.name==="Uint8Array"}function X(e,t=""){if(!Number.isSafeInteger(e)||e<0){let i=t&&`"${t}" `;throw new Error(`${i}expected integer >0, got ${e}`)}}function H(e,t,i=""){let r=Ct(e),n=e?.length,o=t!==void 0;if(!r||o&&n!==t){let s=i&&`"${i}" `,u=o?` of length ${t}`:"",f=r?`length=${n}`:`type=${typeof e}`;throw new Error(s+"expected Uint8Array"+u+", got "+f)}return e}function D(e,t=!0){if(e.destroyed)throw new Error("Hash instance has been destroyed");if(t&&e.finished)throw new Error("Hash#digest() has already been called")}function ut(e,t){H(e,void 0,"digestInto() output");let i=t.outputLen;if(e.length<i)throw new Error('"digestInto() output" expected to be of length >='+i)}function ct(e){return new Uint32Array(e.buffer,e.byteOffset,Math.floor(e.byteLength/4))}function Z(...e){for(let t=0;t<e.length;t++)e[t].fill(0)}var Rt=new Uint8Array(new Uint32Array([287454020]).buffer)[0]===68;function $t(e){return e<<24&4278190080|e<<8&16711680|e>>>8&65280|e>>>24&255}function Qt(e){for(let t=0;t<e.length;t++)e[t]=$t(e[t]);return e}var q=Rt?e=>e:Qt;function G(e,t={}){let i=(n,o)=>e(o).update(n).digest(),r=e(void 0);return i.outputLen=r.outputLen,i.blockLen=r.blockLen,i.create=n=>e(n),Object.assign(i,t),Object.freeze(i)}var P=e=>({oid:Uint8Array.from([6,9,96,134,72,1,101,3,4,2,e])});var Xt=BigInt(0),z=BigInt(1),Dt=BigInt(2),Zt=BigInt(7),qt=BigInt(256),Gt=BigInt(113),ft=[],ht=[],pt=[];for(let e=0,t=z,i=1,r=0;e<24;e++){[i,r]=[r,(2*i+3*r)%5],ft.push(2*(5*r+i)),ht.push((e+1)*(e+2)/2%64);let n=Xt;for(let o=0;o<7;o++)t=(t<<z^(t>>Zt)*Gt)%qt,t&Dt&&(n^=z<<(z<<BigInt(o))-z);pt.push(n)}var dt=rt(pt,!0),Jt=dt[0],Wt=dt[1],at=(e,t,i)=>i>32?ot(e,t,i):nt(e,t,i),lt=(e,t,i)=>i>32?st(e,t,i):it(e,t,i);function Yt(e,t=24){let i=new Uint32Array(10);for(let r=24-t;r<24;r++){for(let s=0;s<10;s++)i[s]=e[s]^e[s+10]^e[s+20]^e[s+30]^e[s+40];for(let s=0;s<10;s+=2){let u=(s+8)%10,f=(s+2)%10,m=i[f],a=i[f+1],w=at(m,a,1)^i[u],U=lt(m,a,1)^i[u+1];for(let b=0;b<50;b+=10)e[s+b]^=w,e[s+b+1]^=U}let n=e[2],o=e[3];for(let s=0;s<24;s++){let u=ht[s],f=at(n,o,u),m=lt(n,o,u),a=ft[s];n=e[a],o=e[a+1],e[a]=f,e[a+1]=m}for(let s=0;s<50;s+=10){for(let u=0;u<10;u++)i[u]=e[s+u];for(let u=0;u<10;u++)e[s+u]^=~i[(u+2)%10]&i[(u+4)%10]}e[0]^=Jt[r],e[1]^=Wt[r]}Z(i)}var N=class e{constructor(t,i,r,n=!1,o=24){if(Object.defineProperty(this,"state",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"pos",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"posOut",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"finished",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"state32",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"destroyed",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"blockLen",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"suffix",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"outputLen",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"enableXOF",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"rounds",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.blockLen=t,this.suffix=i,this.outputLen=r,this.enableXOF=n,this.rounds=o,X(r,"outputLen"),!(0<t&&t<200))throw new Error("only keccak-f1600 function is supported");this.state=new Uint8Array(200),this.state32=ct(this.state)}clone(){return this._cloneInto()}keccak(){q(this.state32),Yt(this.state32,this.rounds),q(this.state32),this.posOut=0,this.pos=0}update(t){D(this),H(t);let{blockLen:i,state:r}=this,n=t.length;for(let o=0;o<n;){let s=Math.min(i-this.pos,n-o);for(let u=0;u<s;u++)r[this.pos++]^=t[o++];this.pos===i&&this.keccak()}return this}finish(){if(this.finished)return;this.finished=!0;let{state:t,suffix:i,pos:r,blockLen:n}=this;t[r]^=i,i&128&&r===n-1&&this.keccak(),t[n-1]^=128,this.keccak()}writeInto(t){D(this,!1),H(t),this.finish();let i=this.state,{blockLen:r}=this;for(let n=0,o=t.length;n<o;){this.posOut>=r&&this.keccak();let s=Math.min(r-this.posOut,o-n);t.set(i.subarray(this.posOut,this.posOut+s),n),this.posOut+=s,n+=s}return t}xofInto(t){if(!this.enableXOF)throw new Error("XOF is not possible for this instance");return this.writeInto(t)}xof(t){return X(t),this.xofInto(new Uint8Array(t))}digestInto(t){if(ut(t,this),this.finished)throw new Error("digest() was already called");return this.writeInto(t),this.destroy(),t}digest(){return this.digestInto(new Uint8Array(this.outputLen))}destroy(){this.destroyed=!0,Z(this.state)}_cloneInto(t){let{blockLen:i,suffix:r,outputLen:n,rounds:o,enableXOF:s}=this;return t||=new e(i,r,n,s,o),t.state32.set(this.state32),t.pos=this.pos,t.posOut=this.posOut,t.finished=this.finished,t.rounds=o,t.suffix=r,t.outputLen=n,t.enableXOF=s,t.destroyed=this.destroyed,t}},yt=(e,t,i,r={})=>G(()=>new N(t,e,i),r),L=yt(6,136,32,P(8)),O=yt(6,72,64,P(10));var _t=(e,t,i,r={})=>G((n={})=>new N(t,e,n.dkLen===void 0?i:n.dkLen,!0),r),B=_t(31,168,16,P(11)),S=_t(31,136,32,P(12));var te={},bt=ee(globalThis,te);function ee(e,t){return new Proxy(e,{get(i,r,n){return r in t?t[r]:e[r]},set(i,r,n){return r in t&&delete t[r],e[r]=n,!0},deleteProperty(i,r){let n=!1;return r in t&&(delete t[r],n=!0),r in e&&(delete e[r],n=!0),n},ownKeys(i){let r=Reflect.ownKeys(e),n=Reflect.ownKeys(t),o=new Set(n);return[...r.filter(s=>!o.has(s)),...n]},defineProperty(i,r,n){return r in t&&delete t[r],Reflect.defineProperty(e,r,n),!0},getOwnPropertyDescriptor(i,r){return r in t?Reflect.getOwnPropertyDescriptor(t,r):Reflect.getOwnPropertyDescriptor(e,r)},has(i,r){return r in t||r in e}})}function h(e){return e%256}function _(e){return e>=-32768&&e<=32767?e:e<-32768?(e=e+32769,e=e%65536,32767+e):(e=e-32768,e=e%65536,-32768+e)}function c(e){return e%65536}function K(e){return e>=-2147483648&&e<=2147483647?e:e<-2147483648?(e=e+2147483649,e=e%4294967296,2147483647+e):(e=e-2147483648,e=e%4294967296,-2147483648+e)}function y(e){return e%4294967296}function wt(e,t){if(e.length!=t.length)return 0;let i=new Uint8Array([0]);for(let n=0;n<e.length;n++)i[0]|=e[n]^t[n];let r=new Uint8Array([0]);return r[0]=~(i[0]^r[0]),r[0]&=r[0]>>4,r[0]&=r[0]>>2,r[0]&=r[0]>>1,r[0]}function mt(e,t){if(e.length!=t.length)return!1;for(let i=0;i<e.length;i++)if(e[i]!==t[i])return!1;return!0}async function kt(){if(typeof bt<"u"&&globalThis.crypto!==void 0)return globalThis.crypto;try{let{webcrypto:e}=await import("crypto");return e}catch{throw new Error("failed to load Crypto")}}function I(e,t,i){return S.create({dkLen:e}).update(t).update(new Uint8Array([i])).digest()}function gt(e){let t=y(e[0]);return t|=y(e[1])<<8,t|=y(e[2])<<16,t}function xt(e){let t=y(e[0]);return t|=y(e[1])<<8,t|=y(e[2])<<16,t|=y(e[3])<<24,y(t)}var A=class{constructor(){Object.defineProperty(this,"_api",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_k",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"_du",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"_dv",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"_eta1",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"_eta2",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"_skSize",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"_pkSize",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"_compressedUSize",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"_compressedVSize",{enumerable:!0,configurable:!0,writable:!0,value:0})}async generateKeyPair(){await this._setup();try{let t=new Uint8Array(64);return this._api.getRandomValues(t),this._deriveKeyPair(t)}catch(t){throw new k(t)}}async deriveKeyPair(t){await this._setup();try{if(t.byteLength!==64)throw new Error("seed must be 64 bytes in length");return this._deriveKeyPair(t)}catch(i){throw new k(i)}}async encap(t,i){await this._setup();try{if(t.length!==384*this._k+32)throw new Error("invalid encapsulation key");let r=this._getSeed(i),[n,o]=J(r,At(t));return[this._encap(t,r,o),n]}catch(r){throw new k(r)}}async decap(t,i){await this._setup();try{if(t.byteLength!==this._compressedUSize+this._compressedVSize)throw new Error("Invalid ct size");if(i.length!==768*this._k+96)throw new Error("Invalid decapsulation key");let r=i.subarray(0,this._skSize),n=i.subarray(this._skSize,this._skSize+this._pkSize),o=i.subarray(this._skSize+this._pkSize,this._skSize+this._pkSize+32),s=i.subarray(this._skSize+this._pkSize+32,this._skSize+this._pkSize+64),u=this._decap(t,r),[f,m]=J(u,o),a=ie(s,t),w=this._encap(n,u,m);return wt(t,w)===1?f:a}catch(r){throw new k(r)}}async _setup(){this._api===void 0&&(this._api=await kt())}_getSeed(t){if(t==null){let i=new Uint8Array(32);return this._api.getRandomValues(i),i}if(t.byteLength!==32)throw new Error("seed must be 32 bytes in length");return t}_deriveKeyPair(t){let i=t.subarray(0,32),r=t.subarray(32,64),[n,o]=this._deriveCpaKeyPair(i),s=At(n),u=new Uint8Array(this._skSize+this._pkSize+64);return u.set(o,0),u.set(n,this._skSize),u.set(s,this._skSize+this._pkSize),u.set(r,this._skSize+this._pkSize+32),[n,u]}_deriveCpaKeyPair(t){let[i,r]=J(t,new Uint8Array([this._k])),n=this._sampleMatrix(i,!1),o=this._sampleNoise1(r,0,this._k),s=this._sampleNoise1(r,this._k,this._k);for(let a=0;a<this._k;a++)o[a]=M(o[a]),o[a]=v(o[a]),s[a]=M(s[a]);let u=new Array(this._k);for(let a=0;a<this._k;a++)u[a]=ce(V(n[a],o)),u[a]=T(u[a],s[a]),u[a]=v(u[a]);let f=new Uint8Array(this._pkSize);for(let a=0;a<this._k;a++)f.set(W(u[a]),a*384);f.set(i,this._skSize);let m=new Uint8Array(this._skSize);for(let a=0;a<this._k;a++)m.set(W(o[a]),a*384);return[f,m]}_encap(t,i,r){let n=new Array(this._k),o=new Uint8Array(384*this._k);for(let p=0;p<this._k;p++)n[p]=St(t.subarray(p*384,(p+1)*384)),o.set(W(n[p]),p*384);if(!mt(t.subarray(0,o.length),o))throw new Error("invalid encapsulation key");let s=t.subarray(this._skSize),u=this._sampleMatrix(s,!0),f=this._sampleNoise1(r,0,this._k),m=this._sampleNoise2(r,this._k,this._k),a=this._sampleNoise2(r,this._k*2,1)[0];for(let p=0;p<this._k;p++)f[p]=M(f[p]),f[p]=v(f[p]);let w=new Array(this._k);for(let p=0;p<this._k;p++)w[p]=V(u[p],f),w[p]=Y(w[p]),w[p]=T(w[p],m[p]),w[p]=v(w[p]);let U=ue(i),b=V(n,f);b=Y(b),b=T(b,a),b=T(b,U),b=v(b);let g=new Uint8Array(this._compressedUSize+this._compressedVSize);return this._compressU(g.subarray(0,this._compressedUSize),w),this._compressV(g.subarray(this._compressedUSize),b),g}_decap(t,i){let r=this._decompressU(t.subarray(0,this._compressedUSize)),n=this._decompressV(t.subarray(this._compressedUSize)),o=this._polyvecFromBytes(i);for(let u=0;u<this._k;u++)r[u]=M(r[u]);let s=V(o,r);return s=Y(s),s=ae(n,s),s=v(s),se(s)}_sampleMatrix(t,i){let r=new Array(this._k),n=new Uint8Array(2);for(let o=0,s=0;s<this._k;s++){r[s]=new Array(this._k);for(let u=0;u<this._k;u++){i?(n[0]=s,n[1]=u):(n[0]=u,n[1]=s);let f=oe(t,n),m=vt(f.subarray(0,504),504,256);for(r[s][u]=m[0],o=m[1];o<256;){let a=f.subarray(504,672),w=vt(a,168,256-o),U=w[0],b=w[1];for(let g=o;g<256;g++)r[s][u][g]=U[g-o];o=o+b}}}return r}_sampleNoise1(t,i,r){let n=new Array(r);for(let o=0;o<r;o++)n[o]=Ut(I(this._eta1*256/4,t,i),this._eta1),i++;return n}_sampleNoise2(t,i,r){let n=new Array(r);for(let o=0;o<r;o++)n[o]=Ut(I(this._eta2*256/4,t,i),this._eta2),i++;return n}_polyvecFromBytes(t){let i=new Array(this._k);for(let r=0;r<this._k;r++)i[r]=St(t.subarray(r*384,(r+1)*384));return i}_compressU(t,i){let r=new Array(4);for(let n=0,o=0;o<this._k;o++)for(let s=0;s<256/4;s++){for(let u=0;u<4;u++)r[u]=((i[o][4*s+u]<<10)+3329/2)/3329&1023;t[n++]=h(r[0]>>0),t[n++]=h(r[0]>>8|r[1]<<2),t[n++]=h(r[1]>>6|r[2]<<4),t[n++]=h(r[2]>>4|r[3]<<6),t[n++]=h(r[3]>>2)}return t}_compressV(t,i){let r=new Uint8Array(8);for(let n=0,o=0;o<256/8;o++){for(let s=0;s<8;s++)r[s]=h(((i[8*o+s]<<4)+3329/2)/3329)&15;t[n++]=r[0]|r[1]<<4,t[n++]=r[2]|r[3]<<4,t[n++]=r[4]|r[5]<<4,t[n++]=r[6]|r[7]<<4}return t}_decompressU(t){let i=new Array(this._k);for(let n=0;n<this._k;n++)i[n]=new Array(384);let r=new Array(4);for(let n=0,o=0;o<this._k;o++)for(let s=0;s<256/4;s++){r[0]=c(t[n+0])>>0|c(t[n+1])<<8,r[1]=c(t[n+1])>>2|c(t[n+2])<<6,r[2]=c(t[n+2])>>4|c(t[n+3])<<4,r[3]=c(t[n+3])>>6|c(t[n+4])<<2,n=n+5;for(let u=0;u<4;u++)i[o][4*s+u]=_(y(r[u]&1023)*y(3329)+512>>10)}return i}_decompressV(t){let i=new Array(384);for(let r=0,n=0;n<256/2;n++,r++)i[2*n+0]=_(c(t[r]&15)*c(3329)+8>>4),i[2*n+1]=_(c(t[r]>>4)*c(3329)+8>>4);return i}};function J(e,t){let i=O.create().update(e);t!==void 0&&i.update(t);let r=i.digest();return[r.subarray(0,32),r.subarray(32,64)]}function At(e){return L.create().update(e).digest()}function ie(e,t){let i=S.create({dkLen:32}).update(e);return t!==void 0&&i.update(t),i.digest()}function oe(e,t){return B.create({dkLen:672}).update(e).update(t).digest()}function W(e){let t=0,i=0,r=new Uint8Array(384),n=Bt(e);for(let o=0;o<256/2;o++)t=c(n[2*o]),i=c(n[2*o+1]),r[3*o+0]=h(t>>0),r[3*o+1]=h(t>>8)|h(i<<4),r[3*o+2]=h(i>>4);return r}function St(e){let t=new Array(384).fill(0);for(let i=0;i<256/2;i++)t[2*i]=_((c(e[3*i+0])>>0|c(e[3*i+1])<<8)&4095),t[2*i+1]=_((c(e[3*i+1])>>4|c(e[3*i+2])<<4)&4095);return t}function se(e){let t=new Uint8Array(32),i,r=Bt(e);for(let n=0;n<256/8;n++){t[n]=0;for(let o=0;o<8;o++)i=((c(r[8*n+o])<<1)+c(3329/2))/c(3329)&1,t[n]|=h(i<<o)}return t}function ue(e){let t=new Array(384).fill(0),i;for(let r=0;r<256/8;r++)for(let n=0;n<8;n++)i=-1*_(e[r]>>n&1),t[8*r+n]=i&_(3330/2);return t}function vt(e,t,i){let r=new Array(384).fill(0),n=0,o,s;for(let u=0;n<i&&u+3<=t;)o=(c(e[u]>>0)|c(e[u+1])<<8)&4095,s=(c(e[u+1]>>4)|c(e[u+2])<<4)&4095,u=u+3,o<3329&&(r[n]=o,n=n+1),n<i&&s<3329&&(r[n]=s,n=n+1);return[r,n]}function Ut(e,t){let i,r,n,o,s=new Array(384).fill(0);for(let u=0;u<256/8;u++){i=xt(e.subarray(4*u,e.length)),r=i&1431655765,r=r+(i>>1&1431655765);for(let f=0;f<8;f++)n=_(r>>4*f+0&3),o=_(r>>4*f+t&3),s[8*u+f]=n-o}return s}function M(e){for(let t=0,i=1,r=128;r>=2;r>>=1)for(let n=0;n<256;n=t+r){let o=E[i];for(i=i+1,t=n;t<n+r;t++){let s=x(o,e[t+r]);e[t+r]=e[t]-s,e[t]=e[t]+s}}return e}function x(e,t){return Ot(e*t)}function v(e){for(let t=0;t<256;t++)e[t]=Lt(e[t]);return e}function Lt(e){let i=(16777216+3329/2)/3329*e>>24;return i=i*3329,e-i}function Ot(e){let i=_(K(e)*62209)*3329;return i=e-i,i>>=16,_(i)}function ce(e){for(let i=0;i<256;i++)e[i]=Ot(K(e[i])*K(1353));return e}function V(e,t){let i=Pt(e[0],t[0]),r;for(let n=1;n<e.length;n++)r=Pt(e[n],t[n]),i=T(i,r);return v(i)}function Pt(e,t){let i,r;for(let n=0;n<256/4;n++)i=zt(e[4*n+0],e[4*n+1],t[4*n+0],t[4*n+1],E[64+n]),r=zt(e[4*n+2],e[4*n+3],t[4*n+2],t[4*n+3],-E[64+n]),e[4*n+0]=i[0],e[4*n+1]=i[1],e[4*n+2]=r[0],e[4*n+3]=r[1];return e}function zt(e,t,i,r,n){let o=new Array(2);return o[0]=x(t,r),o[0]=x(o[0],n),o[0]+=x(e,i),o[1]=x(e,r),o[1]+=x(t,i),o}function T(e,t){let i=new Array(384);for(let r=0;r<256;r++)i[r]=e[r]+t[r];return i}function ae(e,t){for(let i=0;i<256;i++)e[i]-=t[i];return e}function Y(e){let t=0;for(let i=0,r=2;r<=128;r<<=1)for(let n=0;n<256;n=t+r){let o=Q[i];for(i=i+1,t=n;t<n+r;t++){let s=e[t];e[t]=Lt(s+e[t+r]),e[t+r]=s-e[t+r],e[t+r]=x(o,e[t+r])}}for(t=0;t<256;t++)e[t]=x(e[t],Q[127]);return e}function Bt(e){for(let t=0;t<256;t++)e[t]-=3329,e[t]+=e[t]>>31&3329;return e}var C=class extends A{constructor(){super(),Object.defineProperty(this,"_k",{enumerable:!0,configurable:!0,writable:!0,value:2}),Object.defineProperty(this,"_du",{enumerable:!0,configurable:!0,writable:!0,value:10}),Object.defineProperty(this,"_dv",{enumerable:!0,configurable:!0,writable:!0,value:4}),Object.defineProperty(this,"_eta1",{enumerable:!0,configurable:!0,writable:!0,value:3}),Object.defineProperty(this,"_eta2",{enumerable:!0,configurable:!0,writable:!0,value:2}),this._skSize=12*this._k*256/8,this._pkSize=this._skSize+32,this._compressedUSize=this._k*this._du*256/8,this._compressedVSize=this._dv*256/8}_sampleNoise1(t,i,r){let n=new Array(r);for(let o=0;o<r;o++)n[o]=le(I(this._eta1*256/4,t,i),this._eta1),i++;return n}};function le(e,t){let i,r,n,o,s=new Array(384).fill(0);for(let u=0;u<256/4;u++){i=gt(e.subarray(3*u,e.length)),r=i&2396745,r=r+(i>>1&2396745),r=r+(i>>2&2396745);for(let f=0;f<4;f++)n=_(r>>6*f+0&7),o=_(r>>6*f+t&7),s[4*u+f]=n-o}return s}var R=class extends A{constructor(){super(),Object.defineProperty(this,"_k",{enumerable:!0,configurable:!0,writable:!0,value:3}),Object.defineProperty(this,"_du",{enumerable:!0,configurable:!0,writable:!0,value:10}),Object.defineProperty(this,"_dv",{enumerable:!0,configurable:!0,writable:!0,value:4}),Object.defineProperty(this,"_eta1",{enumerable:!0,configurable:!0,writable:!0,value:2}),Object.defineProperty(this,"_eta2",{enumerable:!0,configurable:!0,writable:!0,value:2}),this._skSize=12*this._k*256/8,this._pkSize=this._skSize+32,this._compressedUSize=this._k*this._du*256/8,this._compressedVSize=this._dv*256/8}};var $=class extends A{constructor(){super(),Object.defineProperty(this,"_k",{enumerable:!0,configurable:!0,writable:!0,value:4}),Object.defineProperty(this,"_du",{enumerable:!0,configurable:!0,writable:!0,value:11}),Object.defineProperty(this,"_dv",{enumerable:!0,configurable:!0,writable:!0,value:5}),Object.defineProperty(this,"_eta1",{enumerable:!0,configurable:!0,writable:!0,value:2}),Object.defineProperty(this,"_eta2",{enumerable:!0,configurable:!0,writable:!0,value:2}),this._skSize=12*this._k*256/8,this._pkSize=this._skSize+32,this._compressedUSize=this._k*this._du*256/8,this._compressedVSize=this._dv*256/8}_compressU(t,i){let r=new Array(8);for(let n=0,o=0;o<this._k;o++)for(let s=0;s<256/8;s++){for(let u=0;u<8;u++)r[u]=c(((y(i[o][8*s+u])<<11)+y(3329/2))/y(3329)&2047);t[n++]=h(r[0]>>0),t[n++]=h(r[0]>>8|r[1]<<3),t[n++]=h(r[1]>>5|r[2]<<6),t[n++]=h(r[2]>>2),t[n++]=h(r[2]>>10|r[3]<<1),t[n++]=h(r[3]>>7|r[4]<<4),t[n++]=h(r[4]>>4|r[5]<<7),t[n++]=h(r[5]>>1),t[n++]=h(r[5]>>9|r[6]<<2),t[n++]=h(r[6]>>6|r[7]<<5),t[n++]=h(r[7]>>3)}return t}_compressV(t,i){let r=new Uint8Array(8);for(let n=0,o=0;o<256/8;o++){for(let s=0;s<8;s++)r[s]=h(((y(i[8*o+s])<<5)+y(3329/2))/y(3329))&31;t[n++]=h(r[0]>>0|r[1]<<5),t[n++]=h(r[1]>>3|r[2]<<2|r[3]<<7),t[n++]=h(r[3]>>1|r[4]<<4),t[n++]=h(r[4]>>4|r[5]<<1|r[6]<<6),t[n++]=h(r[6]>>2|r[7]<<3)}return t}_decompressU(t){let i=new Array(this._k);for(let n=0;n<this._k;n++)i[n]=new Array(384);let r=new Array(8);for(let n=0,o=0;o<this._k;o++)for(let s=0;s<256/8;s++){r[0]=c(t[n+0])>>0|c(t[n+1])<<8,r[1]=c(t[n+1])>>3|c(t[n+2])<<5,r[2]=c(t[n+2])>>6|c(t[n+3])<<2|c(t[n+4])<<10,r[3]=c(t[n+4])>>1|c(t[n+5])<<7,r[4]=c(t[n+5])>>4|c(t[n+6])<<4,r[5]=c(t[n+6])>>7|c(t[n+7])<<1|c(t[n+8])<<9,r[6]=c(t[n+8])>>2|c(t[n+9])<<6,r[7]=c(t[n+9])>>5|c(t[n+10])<<3,n=n+11;for(let u=0;u<8;u++)i[o][8*s+u]=y(r[u]&2047)*3329+1024>>11}return i}_decompressV(t){let i=new Array(384),r=new Array(8);for(let n=0,o=0;o<256/8;o++){r[0]=t[n+0]>>0,r[1]=t[n+0]>>5|t[n+1]<<3,r[2]=t[n+1]>>2,r[3]=t[n+1]>>7|t[n+2]<<1,r[4]=t[n+2]>>4|t[n+3]<<4,r[5]=t[n+3]>>1,r[6]=t[n+3]>>6|t[n+4]<<2,r[7]=t[n+4]>>3,n=n+5;for(let s=0;s<8;s++)i[8*o+s]=_(y(r[s]&31)*y(3329)+16>>5)}return i}};return Mt(fe);})();
/*! Bundled license information:

mlkem/esm/src/sha3/utils.js:
  (*! noble-hashes - MIT License (c) 2022 Paul Miller (paulmillr.com) *)
*/
